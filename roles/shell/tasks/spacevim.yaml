---
# Anarres :: shell :: spacevim
#
# Role to  configure SpaceVim.
#
- name: Download SpaceVim
  ansible.builtin.get_url:
    url: https://spacevim.org/install.sh
    dest: "{{ home }}/.oh-my-zsh/spacevim-install.sh"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: "0750"
  notify: Install SpaceVim

- name: Enable colorschemes in SpaceVim
  ansible.builtin.blockinfile:
    append_newline: true
    block: |
      [[layers]]
      name = "colorscheme"
    path: "{{ home }}/.SpaceVim.d/init.toml"
    prepend_newline: true

- name: Set colorscheme for SpaceVim
  ansible.builtin.lineinfile:
    backrefs: true
    line: '\1 = "{{ spacevim.colorscheme }}"'
    path: "{{ home }}/.SpaceVim.d/init.toml"
    regexp: "^(.*colorscheme) ="
    state: present
  when: "spacevim.colorscheme is not none"
